<div class="prl-tablerow-expanded">
  <span class="prl-tablerow-expanded-heading">Description:</span>
  {{description}}
  <span ng-if="multiVariateDescription" class="prl-tablerow-expanded-mv-description">{{multiVariateDescription}}</span>

  <span ng-if="isShowingAggregatedData === true" class="prl-tablerow-expanded-heading">Details on highest severity anomaly:</span>
  <span ng-if="isShowingAggregatedData === false" class="prl-tablerow-expanded-heading">Anomaly Details:</span>
  <div ng-if="isInterim === true" class="prl-anomaly-summary-interim"><i class="fa fa-exclamation-triangle"></i> Interim result</div>
  <table>
    <tr ng-if="record.source.partition_field_value">
      <td>{{record.source.partition_field_name}}:</td>
      <td>{{record.source.partition_field_value}}
        <i ng-click="filter(record.source.partition_field_name, record.source.partition_field_value, '+')"
            tooltip="Filter for value" tooltip-append-to-body="1" class="fa fa-search-plus"></i>
        <i ng-click="filter(record.source.partition_field_name, record.source.partition_field_value, '-')"
            tooltip="Filter out value" tooltip-append-to-body="1" class="fa fa-search-minus"></i>
      </td>
    </tr>
    <tr ng-if="record.source.byFieldValue">
      <td>{{record.source.byFieldName}}:</td>
      <td>{{record.source.byFieldValue}}
        <i ng-click="filter(record.source.by_field_name, record.source.by_field_value, '+')"
            tooltip="Filter for value" tooltip-append-to-body="1" class="fa fa-search-plus"></i>
        <i ng-click="filter(record.source.by_field_name, record.source.by_field_value, '-')"
            tooltip="Filter out value" tooltip-append-to-body="1" class="fa fa-search-minus"></i>
      </td>
    </tr>
    <tr ng-if="singleCauseByFieldValue">
      <td>{{singleCauseByFieldName}}:</td>
      <td>{{singleCauseByFieldValue}}
        <i ng-click="filter(singleCauseByFieldName, singleCauseByFieldValue, '+')"
            tooltip="Filter for value" tooltip-append-to-body="1" class="fa fa-search-plus"></i>
        <i ng-click="filter(singleCauseByFieldName, singleCauseByFieldValue, '-')"
            tooltip="Filter out value" tooltip-append-to-body="1" class="fa fa-search-minus"></i>
      </td>
    </tr>
    <tr ng-if="record.source.over_field_value">
      <td>{{record.source.over_field_name}}:</td>
      <td>{{record.source.over_field_value}}
        <i ng-click="filter(record.source.over_field_name, record.source.over_field_value, '+')"
            tooltip="Filter for value" tooltip-append-to-body="1" class="fa fa-search-plus"></i>
        <i ng-click="filter(record.source.over_field_name, record.source.over_field_value, '-')"
            tooltip="Filter out value" tooltip-append-to-body="1" class="fa fa-search-minus"></i>
      </td>
    </tr>
    <tr ng-if="anomalyEndTime"><td>time:</td><td>{{anomalyTime}} to {{anomalyEndTime}}</td></tr>
    <tr ng-if="!anomalyEndTime"><td>time:</td><td>{{anomalyTime}}</td></tr>
    <tr ng-if="examples" ng-repeat="example in examples track by $index">
      <td ng-if="$index === 0">category examples:</td><td ng-if="$index > 0">&nbsp;</td>
      <td>{{example}}</td>
    </tr>
    <tr><td>function:</td><td>{{record.source.function}}</td></tr>
    <tr ng-if="record.source.field_name"><td>fieldName:</td><td>{{record.source.field_name}}</td></tr>
    <tr ng-if="actual !== undefined"><td>actual:</td><td>{{actual | timeOfWeek:record.source.function}}</td></tr>
    <tr ng-if="typical !== undefined"><td>typical:</td><td>{{typical | timeOfWeek:record.source.function}}</td></tr>
    <tr>
      <td>job ID:</td>
      <td>{{record.jobId}}
        <i ng-click="filter('job_id', record.jobId, '+')"
            tooltip="Filter for value" tooltip-append-to-body="1" class="fa fa-search-plus"></i>
        <i ng-click="filter('job_id', record.jobId, '-')"
            tooltip="Filter out value" tooltip-append-to-body="1" class="fa fa-search-minus"></i>
      </td>

    </tr>
    </tr>
    <tr><td>probability:</td><td>{{record.source.probability}}</td></tr>
    <tr ng-if="causes" ng-repeat="cause in causes track by $index">
      <td ng-if="$index === 0">{{cause.entityName}} values:</td><td ng-if="$index > 0">&nbsp;</td>
      <td>{{cause.entityValue}} (actual {{cause.actual}}, typical {{cause.typical}}, probability {{cause.probability}})
        <i ng-click="filter(cause.entityName, cause.entityValue, '+')"
            tooltip="Filter for value" tooltip-append-to-body="1" class="fa fa-search-plus"></i>
        <i ng-click="filter(cause.entityName, cause.entityValue, '-')"
            tooltip="Filter out value" tooltip-append-to-body="1" class="fa fa-search-minus"></i>
      </td>
    </tr>
  </table>

  <span ng-if="influencers" class="prl-tablerow-expanded-heading">Influenced by:</span>
  <table ng-if="influencers">
    <tr ng-repeat="influencer in influencers">
      <td>{{influencer.name}}</td>
      <td>{{influencer.value}}
        <i ng-click="filter(influencer.name, influencer.value, '+')"
            tooltip="Filter for value" tooltip-append-to-body="1" class="fa fa-search-plus"></i>
        <i ng-click="filter(influencer.name, influencer.value, '-')"
            tooltip="Filter out value" tooltip-append-to-body="1" class="fa fa-search-minus"></i>
      </td>

    </tr>
  </table>

</div>
