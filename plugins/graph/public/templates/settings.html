
  <nav class="navbar navbar-default navbar-static-top subnav" ng-show="selectedIndex!=null">
    <ul class="nav navbar-nav">
      <li ng-show="workspace" ng-class="{active:configPanel=='lastRequest'}">
        <a class="navbar-link" ng-click="configPanel='lastRequest'">Last request</a>
      </li>
      <li ng-show="workspace" ng-class="{active:configPanel=='blacklist'}">
        <a class="navbar-link" ng-click="configPanel='blacklist'">Blacklist</a>
      </li>
      <li ng-class="{active:configPanel=='settings'}">
        <a class="navbar-link" ng-click="configPanel='settings'">Advanced settings</a>
      </li>
    </ul>
  </nav>

  <!--========= Begin config =========== -->
  <div class="config" >
    <div class="container-fluid">

      <!-- ====== start Spy ====== -->
      <div class="container" ng-if="(workspace!=null)&&(configPanel=='lastRequest')">
        <div>
          <small class="help-block">http://host:port/{{selectedIndex.name}}/_xpack/_graph/_explore</small>
          <ul class="nav nav-tabs">
            <li ng-class="{active: spymode == 'request'}"><a ng-click="spymode='request'">Request</a></li>
            <li ng-class="{active: spymode == 'response'}"><a ng-click="spymode='response'">Response</a></li>
          </ul>

          <div ng-show="spymode == 'request'" ui-ace="{ onLoad: aceLoaded, mode: 'json', advanced: { readOnly: true } }" ng-model="workspace.lastRequest" class="requestJsonView"></div>
          <div ng-show="spymode == 'response'" ui-ace="{ onLoad: aceLoaded, mode: 'json', advanced: { readOnly: true } }" ng-model="workspace.lastResponse" class="requestJsonView"></div>
        </div>
      </div>
      <div>
        <!-- ====== end spy ======== -->



        <!-- ====== start blacklist ====== -->
        <div class="container" ng-if="(workspace!=null)&&(configPanel=='blacklist')">
          <p class="help-block">These terms are currently blacklisted from re-appearing in the workspace</p>

          <div class="selectionList">
            <div ng-repeat="n in workspace.blacklistedNodes">
              <i class="btn btn-xs fa  fa-times colored-text" ng-click="workspace.unblacklist(n)" ng-class="{type0:n.color==0,type1:n.color==1,type2:n.color==2,type3:n.color==3,type4:n.color==4,type5:n.color==5,type6:n.color==6,type7:n.color==7,type8:n.color==8,type9:n.color==9}"></i>              {{n.label}}
            </div>
          </div>
          <button tooltip="Clear blacklist" type="button" class="btn btn-default btn-xs " ng-click="workspace.blacklistedNodes=[]" ng-disabled="workspace.blacklistedNodes.length ==0">
            <i class="fa  fa-trash"></i> Clear
          </button>
        </div>
        <!-- ====== end blacklist ======== -->


        <!-- ======== begin explore settings ======= -->
        <div class="container" ng-if="(selectedIndex!=null)&&(configPanel=='settings')">

          <form class="form-horizontal">


            <div class="form-group form-group-sm small-graph-form">
              <label for="qIndexSampleSize" class="col-sm-4 control-label">Sample size</label>
              <div class="col-sm-6">
                <input type="number" class="form-control input-sm" min="1" max="500000" step="1000" id="qIndexSampleSize" ng-model="exploreControls.sampleSize">
                <div class="help-block">Terms are identified from samples of the most relevant documents. Bigger is not necessarily better - can be slower and less relevant.
                </div>
              </div>
            </div>


            <div class="form-group">
              <div class="col-sm-offset-4 col-sm-8">
                <div class="checkbox">
                  <label>
                    <input type="checkbox" id="isSignifChk2" ng-model="exploreControls.useSignificance"> Significant links
                  </label>
                </div>
                <span class="help-block">Identify terms that are "significant" rather than simply popular</span>
              </div>
            </div>

            <div class="form-group form-group-sm small-graph-form">
              <label for="minDocCount" class="col-sm-4 control-label">Certainty</label>
              <div class="col-sm-6 ">
                <input type="number" class="form-control input-sm" min="1" max="500000" step="1" id="minDocCount" ng-model="exploreControls.minDocCount">
                <div class="help-block">The min number of documents that are required as evidence before introducing a related term</div>
              </div>
            </div>

            <div class="form-group form-group-sm small-graph-form">
              <label for="qDiversityField" class="col-sm-4 control-label">Diversity field</label>
              <div class="col-sm-6 ">
                <select name="qDiversityField" id="qDiversityField" ng-options="field.name for field in allFields" ng-model="exploreControls.sampleDiversityField">
                  <option value="">[No diversification]</option>
                </select>
                <span class="help-block">To avoid document samples being dominated by a single voice, pick the field that helps identify the source of bias.
                  <em>This must be a single-term field or searches will be rejected with an error</em>
                </span>

              </div>
            </div>
            <div class="form-group form-group-sm small-graph-form" ng-show="exploreControls.sampleDiversityField">
              <label for="qMaxValuesPerDoc" class="col-sm-4 control-label">Max docs per field</label>
              <div class="col-sm-6 ">
                <input type="number" class="form-control input-sm" min="1" max="500000" step="1" id="qMaxValuesPerDoc" ng-model="exploreControls.maxValuesPerDoc">
                <span class="help-block">Max number of documents in a sample that can contain the same value for the
                  <em>{{selectedDiversityField.name}}</em> field</span>
              </div>
            </div>


            <div class="form-group form-group-sm small-graph-form">
              <label for="qTimeoutMillis" class="col-sm-4 control-label">Timeout (ms)</label>
              <div class="col-sm-6 ">
                <input type="number" class="form-control input-sm" min="1" max="500000" step="1" id="qTimeoutMillis" ng-model="exploreControls.timeoutMillis">
                <span class="help-block">Max time in milliseconds a request can run</span>
              </div>
            </div>

            <!--
                        TODO - could add a "guiding query" search term here - would, for example, allow
                        exploration of weblog entries from selected IP addresses etc BUT always where
                        status==404. There's usually a desire to allow exploration to expand and move
                        away from the seed query but sometimes a guiding hand is needed across all
                        expand steps to stay "on topic". The search term would be added to all graph
                        explore calls automatically.
                  -->

          </form>

        </div>

        <!-- ========== end explore settings =========== -->



      </div>

    </div>
  </div>
  <!--========= End config =========== -->
