<div class="ml-field-data-card">
  <div class="title-bar {{ cardConfig.type }}">
    <div ng-if="cardConfig.type === DATA_VISUALIZER_FIELD_TYPES.NUMBER" aria-label="Metric field" class="field-type-icon">
      <strong aria-hidden="true">#</strong>
    </div>
    <span ng-if="cardConfig.type === DATA_VISUALIZER_FIELD_TYPES.KEYWORD" aria-label="Aggregatable string field" class="field-type-icon">
      <strong aria-hidden="true">t</strong>
    </span>
    <span ng-if="cardConfig.type === DATA_VISUALIZER_FIELD_TYPES.TEXT" aria-label="String field" class="field-type-icon kuiIcon fa-file-text-o"></span>
    <span ng-if="cardConfig.type === DATA_VISUALIZER_FIELD_TYPES.IP" aria-label="IP address field" class="field-type-icon kuiIcon fa-laptop"></span>
    <span ng-if="cardConfig.type === DATA_VISUALIZER_FIELD_TYPES.DATE" aria-label="Date field" class="field-type-icon kuiIcon fa-clock-o"></span>
    <div class="field-name">
      {{ cardConfig.fieldName }}
    </div>
  </div>

  <div class="card-contents">

    <div ng-if="cardConfig.type === DATA_VISUALIZER_FIELD_TYPES.NUMBER">
      <div class="stats">
        <div class="stat"><i class="fa fa-files-o" aria-hidden="true"></i>
          {{ stats.count }} <ng-pluralize count="stats.count" when="{'1':'document', 'other':'documents'}">documents</ng-pluralize>
          ({{ 100 * stats.count / stats.totalCount | number:1 }}%)
        </div>
        <div class="stat"><i class="fa fa-cubes" aria-hidden="true"></i> {{ stats.cardinality }} distinct
          <ng-pluralize count="stats.cardinality" when="{'1':'value', 'other':'values'}">values</ng-pluralize>
        </div>
        <div>
          <div class="stat min heading">min</div>
          <div class="stat median heading">median</div>
          <div class="stat max heading">max</div>
        </div>
        <div>
          <div class="stat min">{{ stats.min | number }}</div>
          <div class="stat median">{{ stats.median | number }}</div>
          <div class="stat max">{{ stats.max | number }}</div>
        </div>
      </div>

      <div class="details-select">
        <select class="kuiSelect" ng-model="detailsMode" ng-change="detailsModeChanged(detailsMode)">
          <option value="distribution">distribution of values</option>
          <option value="top">top values</option>
        </select>
      </div>
      <div class="details-container" ng-switch on="detailsMode">
        <ml-metric-distribution-chart ng-switch-when="distribution" width="325" height="220"
          chart-config="cardConfig"
          index-pattern="indexPattern"
          earliest="earliest"
          latest="latest"
          >
        </ml-metric-distribution-chart>
        <div ng-switch-default ng-repeat="value in stats.topValues" class="top-value">
          <div class="field-label"
            tooltip-html-unsafe="{{value.key}}"
            tooltip-placement="right"
            tooltip-append-to-body="true">
            {{value.key | number}}
          </div>
          <div class="top-value-bar-holder">
            <div class="top-value-bar {{cardConfig.type}}" ng-attr-style="width: {{100 * value.doc_count/stats.count}}%;"
              tooltip-html-unsafe="{{ 100 * value.doc_count/stats.count | number:1 }}%"
              tooltip-append-to-body="true"
              tooltip-placement="right">
            </div>
          </div>
          <div class="count-label">{{value.doc_count}}</div>
        </div>
      </div>
    </div>

    <div ng-if="cardConfig.type === DATA_VISUALIZER_FIELD_TYPES.KEYWORD || cardConfig.type === DATA_VISUALIZER_FIELD_TYPES.IP">
      <div class="stats">
        <div class="stat"><i class="fa fa-files-o" aria-hidden="true"></i>
        {{ stats.count }} <ng-pluralize count="stats.count" when="{'1':'document', 'other':'documents'}">documents</ng-pluralize>
          ({{ 100 * stats.count / stats.totalCount | number:1 }}%)
        </div>
        <div class="stat"><i class="fa fa-cubes" aria-hidden="true"></i> {{ stats.cardinality }} distinct
          <ng-pluralize count="stats.cardinality" when="{'1':'value', 'other':'values'}">values</ng-pluralize>
        </div>

      </div>

      <div class="stats">
        <div class="stat">top values</div>
          <div ng-repeat="value in stats.topValues" class="top-value">
            <div class="field-label"
              tooltip-html-unsafe="{{value.key}}"
              tooltip-append-to-body="true"
              tooltip-placement="right">
              {{value.key}}
            </div>
            <div class="top-value-bar-holder">
              <div class="top-value-bar {{cardConfig.type}}" ng-attr-style="width: {{100 * value.doc_count/stats.count}}%;"
                tooltip-html-unsafe="{{ 100 * value.doc_count/stats.count | number:1 }}%"
                tooltip-placement="right"
                tooltip-append-to-body="true">
              </div>
            </div>
            <div class="count-label">{{value.doc_count}}</div>
          </div>
      </div>
    </div>

    <div ng-if="cardConfig.type === DATA_VISUALIZER_FIELD_TYPES.DATE">
      <div class="stats">
        <div class="stat"><i class="fa fa-files-o" aria-hidden="true"></i>
          {{ stats.count }} <ng-pluralize count="stats.count" when="{'1':'document', 'other':'documents'}">documents</ng-pluralize>
          ({{ 100 * stats.count / stats.totalCount | number:1 }}%)
        </div>
        <div class="stat">earliest {{ stats.earliest | moment }}</div>
        <div class="stat">latest {{ stats.latest | moment }}</div>

      </div>
    </div>

    <div ng-if="cardConfig.type === DATA_VISUALIZER_FIELD_TYPES.TEXT">
      <div class="stats">
        <div class="stat"><ng-pluralize count="stats.examples.length" when="{'1':'value', 'other':'examples'}">examples</ng-pluralize></div>
        <div ng-repeat="example in stats.examples">
          {{ example }}
        </div>
      </div>
    </div>

  </div>

</div>

