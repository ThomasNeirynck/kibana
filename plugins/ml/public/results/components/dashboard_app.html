<kbn-top-nav name="dashboard" config="topNavMenu">
  <div class="kibana-nav-info">
    <span ng-show="dash.id" class="kibana-nav-info-title">
      <span ng-bind="::dash.title"></span>
    </span>
  </div>
</kbn-top-nav>

<navbar ng-show="chrome.getVisible()">
  <div class="ml-job-select-btn-label">Job</div>
  <div style="flex:0 0 auto;">
    <button ng-if="selectedJobs.length == 1 && selectedJobs[0].id === '*'"
            popover-placement="bottom" popover-html-unsafe="{{unsafeHtml}}" popover-append-to-body="true" popover-trigger="click"
            class="btn btn-default ml-job-select-btn" tooltip="All jobs selected" tooltip-append-to-body="true">
      <span class="ml-job-select-btn-text">All jobs</span>
      <span class="caret"></span>
    </button>

    <button ng-if="selectedJobs.length == 1 && selectedJobs[0].id !== '*'" popover-placement="bottom"
            popover-placement="bottom" popover-html-unsafe="{{unsafeHtml}}" popover-append-to-body="true" popover-trigger="click"
            class="btn btn-default ml-job-select-btn" tooltip="{{selectedJobs[0].id}} selected" tooltip-append-to-body="true">
      <span class="ml-job-select-btn-text">{{selectedJobs[0].id}}</span>
      <span class="caret"></span>
    </button>

    <button ng-if="selectedJobs.length == 2" popover-placement="bottom"
            popover-placement="bottom" popover-html-unsafe="{{unsafeHtml}}" popover-append-to-body="true" popover-trigger="click"
            class="btn btn-default ml-job-select-btn" tooltip="{{selectedJobs[0].id}} and 1 other job selected" tooltip-append-to-body="true">
      <span class="ml-job-select-btn-text">{{selectJobBtnJobIdLabel}} and 1 other</span>
      <span class="caret"></span>
    </button>

    <button ng-if="selectedJobs.length > 2" popover-placement="bottom"
            popover-placement="bottom" popover-html-unsafe="{{unsafeHtml}}" popover-append-to-body="true" popover-trigger="click"
            class="btn btn-default ml-job-select-btn" tooltip="{{selectedJobs[0].id}} and {{selectedJobs.length-1}} other jobs selected" tooltip-append-to-body="true">
      <span class="ml-job-select-btn-text">{{selectJobBtnJobIdLabel}} and {{selectedJobs.length-1}} others</span>
      <span class="caret"></span>
    </button>

  </div>

  <form name="queryInput"
    class="fill inline-form"
    ng-submit="filterResults()"
    role="form">

    <div class="typeahead" kbn-typeahead="dashboard">

      <div class="input-group"
        ng-class="queryInput.$invalid ? 'has-error' : ''">

        <input
          type="text"
          placeholder="Filter..."
          aria-label="Filter input"
          class="form-control"
          ng-model="model.query"
          input-focus
          kbn-typeahead-input
          parse-query>
        <button type="submit" class="btn btn-default" ng-disabled="queryInput.$invalid" aria-label="Filter dashboards">
          <span aria-hidden="true" class="fa fa-search"></span>
        </button>
      </div>

      <kbn-typeahead-items></kbn-typeahead-items>
    </div>

  </form>

</navbar>

<filter-bar state="state"></filter-bar>

<dashboard-grid
  panels="panels"
  get-vis-click-handler="getFilterBarClickHandler"
  get-vis-brush-handler="getBrushEvent"
  save-state="saveState"
  toggle-expand="toggleExpandPanel"
  create-child-ui-state="createChildUiState"
  toggle-expand="toggleExpandPanel"
></dashboard-grid>
