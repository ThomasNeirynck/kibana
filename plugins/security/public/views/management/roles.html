<kbn-management-app section="elasticsearch">
  <div class="kuiNotice" ng-if="forbidden">
    <div class="kuiNotice__header">
      <h1 class="kuiNoticeTitle">
        <span class="fa fa-times kuiIcon--danger"></span>
        You do not have permission to manage roles
      </h1>
      <div class="kuiNoticeText">
        Please contact your administrator.
      </div>
    </div>
  </div>

  <div class="kuiPage" ng-if="!forbidden">
    <!-- Table controls -->
    <div class="kuiTableControls">
      <div class="kuiTableControls__actions">
        <button
          ng-click="deleteRoles()"
          class="kuiButton kuiButton--danger kuiTableControlAction"
          ng-show="selectedRoles.length"
          tooltip="Delete selected roles"
        >
          <span class="fa fa-trash"></span>
        </button>
        <a
          href="#/management/elasticsearch/roles/edit"
          ng-click="newRole()"
          class="kuiButton kuiButton--primary kuiTableControlAction"
          ng-show="!selectedRoles.length"
          tooltip="Create new role"
        >
          <span class="fa fa-plus"></span>
        </a>
      </div>
      <div class="kuiTableControls__input">
        <form role="form" class="fullWidth">
          <input
            aria-label="Filter"
            ng-model="query"
            class="kuiInput"
            type="text" placeholder="Filter..."
          />
        </form>
      </div>
    </div>

    <!-- Table -->
    <table class="table">
      <thead>
        <tr>
          <th><input type="checkbox" ng-click="toggleAll()" ng-checked="allSelected()" /></th>
          <th ng-click="toggleSort(sort, 'name')">
            Role
            <span aria-hidden="true" class="fa" ng-show="sort.orderBy == 'name'" ng-class="{'fa-caret-down': sort.reverse, 'fa-caret-up': !sort.reverse}"></span>
          </th>
          <th>
            Reserved
            <span
              class="fa fa-question-circle"
              tooltip="Reserved roles are built-in and cannot be removed or modified. Only the password may be changed."
            ></span>
          </th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="role in roles | orderBy:'name' | filter:query | orderBy:sort.orderBy:sort.reverse">
          <td>
            <input type="checkbox" ng-click="toggle(selectedRoles, role)" ng-checked="includes(selectedRoles, role)" ng-disabled="role.metadata._reserved" />
          </td>
          <td>
            <a ng-href="#/management/elasticsearch/roles/edit/{{role.name}}">{{role.name}}</a>
          </td>
          <td>
            <div
              ng-if="role.metadata._reserved"
              class="fa fa-check"
            ></div>
          </td>
        </tr>
        <tr ng-show="!(roles | filter:query).length">
          <td colspan="4">No <span ng-show="query">matching</span> roles found.</td>
        </tr>
      </tbody>
    </table>
  </div>
</kbn-management-app>
